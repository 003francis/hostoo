{% extends 'hostooSanteBundle::blank.html.twig' %}
{% block menu %}
    {% include 'hostooSanteBundle:menus:menunrs.html.twig' %}
{% endblock %}
{% block titrepage %}Fil d'attente patients{% endblock %}
{% block options %}{% endblock %}
{% block body %}
{% set n=1 %}
{% if episodes == null %}
    <h2>Pas de liste</h2>
    {% else %}
        <div class="col-lg-9 col-md-12">

        <div class="row">
            {% if episodes|length != 0 %}
                            <div class="col-sm-12">
                                <div class="timeline">
                                   <article class="timeline-item alt">
                <div class="text-center">
                    <div class="time-show first">
                        <a href="#" class="btn btn-primary w-lg">Aujourd'hui</a>
                    </div>
                </div>
            </article>
                                    {% endif %}
        {% for episode in episodes %}
            {% if episode.verifierConsultation()==1 %}
        {% set n=n+1 %}
            {% if episode.listesoins|length == 0 %}
       <article {% if n is even %}class="timeline-item alt"{% else %}class="timeline-item"{% endif %}>
                                        <div class="timeline-desk">
                                            <div class="panel">
                                                <div class="panel-body">
                                                    <span class="timeline-icon"></span>
                                                <span class="text-custom">{{ episode.dateepisode|date('d-m-Y') }}</span>
               <p>{{ episode.patient.nom }}  {{ episode.patient.postnom }}   {{ episode.patient.prenom }}</p>
                <p>Sexe : {% if episode.patient.sexe == true %}M{% else %}F{% endif %}</p>
                                                    <a href="{{ path('voirpatient_prel',{'id':episode.id }) }}" class="btn btn-custom">Voir</a>
                 </div>
                                            </div>
                                        </div>
                                    </article>






            {#{% if rdvc != null %} <button class="small green"></button>{% else %}<button class="small red"></button>{% endif %}#}

                {#<td><a href="{{ path('hostoo_sante_voirpatient',{'id':patient.id}) }}" class="btn btn-info" > <i class="fa fa-eye"></i>Details</a></td>#}
           {% endif %}{% endif %}
            {% endfor %}
</div>
  </div>
  </div>
  </div>
    <div class="col-lg-3 col-md-12">
        <h4>Patients En Attente des soins</h4>
        <ul class="list-unstyled list-group">
        {% for ls in lsoins %}

            <li class="list-group-item">{{ ls.episode.patient.nom }} {{ ls.episode.patient.postnom }} {{ ls.episode.patient.prenom }} {% if ls.rechecked == true %}<a href="{{ path('voirpatient_prel',{'id':ls.episode.id }) }}" class="btn btn-custom pull-right"><i class="fa fa-eye"></i> </a>  {% endif %}</li>

        {% endfor %}
        </ul>
    </div>
        {% endif %}
{% endblock %}
{% block javascripts %}
{{ parent() }}
    <script src="{{ asset('assets/plugins/jquery-datatables-editable/jquery.dataTables.js') }}"></script>
    <script src="{{ asset('assets/plugins/datatables/dataTables.bootstrap.js') }}"></script>
    <script type="text/javascript" src="{{ asset('assets/plugins/multiselect/js/jquery.multi-select.js') }}"></script>
    <script type="text/javascript" src="{{ asset('assets/plugins/jquery-quicksearch/jquery.quicksearch.js') }}"></script>
    <script src="{{ asset('assets/plugins/select2/dist/js/select2.min.js') }}" type="text/javascript"></script>
    <script>
        $(function () {
           $('#listepatients').dataTable({
               dom: "Bfrtip",
               buttons: [{extend: "copy", className: "btn-sm"}, {extend: "csv", className: "btn-sm"}, {
                   extend: "excel",
                   className: "btn-sm"
               }, {extend: "pdf", className: "btn-sm"}, {extend: "print", className: "btn-sm"}],
               responsive: !0
           });
        });
    </script>
    <script>
$(function () {

    {% for episode in episodes %}
        //advance multiselect start
        $('#my_multi_select{{ episode.id }}').multiSelect({
            selectableHeader: "<input type='text' class='form-control search-input' autocomplete='off' placeholder='search...'>",
            selectionHeader: "<input type='text' class='form-control search-input' autocomplete='off' placeholder='search...'>",
            afterInit: function (ms) {
                var that = this,
                        $selectableSearch = that.$selectableUl.prev(),
                        $selectionSearch = that.$selectionUl.prev(),
                        selectableSearchString = '#' + that.$container.attr('id') + ' .ms-elem-selectable:not(.ms-selected)',
                        selectionSearchString = '#' + that.$container.attr('id') + ' .ms-elem-selection.ms-selected';

                that.qs1 = $selectableSearch.quicksearch(selectableSearchString)
                        .on('keydown', function (e) {
                            if (e.which === 40) {
                                that.$selectableUl.focus();
                                return false;
                            }
                        });

                that.qs2 = $selectionSearch.quicksearch(selectionSearchString)
                        .on('keydown', function (e) {
                            if (e.which == 40) {
                                that.$selectionUl.focus();
                                return false;
                            }
                        });
            },
            afterSelect: function () {
                this.qs1.cache();
                this.qs2.cache();
            },
            afterDeselect: function () {
                this.qs1.cache();
                this.qs2.cache();
            }
        });
    {% endfor %}
    // Select2
    $(".select2").select2();

    $(".select2-limiting").select2({
        placeholder: "Choisir les actes"
    });


});
    </script>
    <script>
        $('#signes_vitaux_taille').on('change',function () {
            var poids=$('#signes_vitaux_poids').val();
            $('#signes_vitaux_imc').val(poids/(Math.pow($(this).val(),2)));
        });

        $('#signes_vitaux_pp').on('change',function () {
            var poids=$('#signes_vitaux_pa').val();
            $('#signes_vitaux_wrh').val($(this).val()/poids,2);
        });
    </script>
{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('assets/plugins/jquery-datatables-editable/datatables.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/plugins/datatables/buttons.bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/plugins/datatables/jquery.dataTables.min.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/plugins/datatables/buttons.bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/plugins/datatables/buttons.bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/plugins/multiselect/css/multi-select.css') }}"  rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/plugins/select2/dist/css/select2.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ asset('assets/plugins/select2/dist/css/select2-bootstrap.css') }}" rel="stylesheet" type="text/css">
{% endblock %}