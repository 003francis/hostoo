{% extends 'hostooSanteBundle::blank.html.twig' %}
{% block menu %}
    {% include 'hostooUserBundle:menus:menuadmin.html.twig' %}
{% endblock %}
{% block titrepage %}{% endblock %}
{% block options %}{% endblock %}
{% block body %}
    {% set nb_formules=tcs|length %}
    <div class="col-lg-10 col-lg-offset-1 col-md-12">

    <form action="{{ path('hostoo_sante_editionformule') }}" method="post">
<div class="card-box">
        <table class="table table-bordered" id="mesactes">
            <thead>
            <tr>
                <th>Les actes médicaux</th>
                {% for formule in tcs %}
                    <th>{{ formule.nom }}<br>({{ formule.fortar|length }})</th>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
    {% if cats == null %}
        <tr><th colspan="{{ nb_formules+1 }}"><div class="alert alert-dismissable alert-danger text-center"><i class="fa fa-warning fa-3x"></i><strong>Les actes Médicaux ne sont pas définis</strong></div></th></tr>
        {% else %}
    {% for cat in cats %}
        <tr>
        <th colspan="{{ tcs|length+1 }}" class="text-center bg-inverse text-white">{{ cat.nom }}</th>

        </tr>
            {% for tar in tarifs %}
                {% if cat.nom == tar.categories.nom %}
<tr>
                <td>{{ tar.designationacte }} </td>
    {% for f in tcs %}
        <td><div class="pull-right"><label>
                    <input type="checkbox" class="js-switch" name="prod[{{ f.id }}][]" value="{{ tar.id }}" {% for fortar in formulecoche %}{% if
                           f.id==fortar.formule.id and tar.id== fortar.acte.id %}checked{% endif %}{% endfor %}/>
                </label></div> </td>
        {% endfor %}
</tr>
    {% endif %}
                    {% endfor %}
{% endfor %}
            {% endif %}
            </tbody>
        </table>
        </div>
        <div class="card-box">

        <table class="table table-bordered" id="mesproduits">
            <thead>
            <tr>
                <th>Les actes médicaux</th>
                {% for formule in tcs %}
                    <th>{{ formule.nom }}<br>({{ formule.forprod|length }})</th>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for cat in produits %}
                <tr><th colspan="{{ tcs|length+1 }}" class="text-center bg-inverse text-white">{{ cat.nom }}</th></tr>
                {% for produit in cat.produit %}
                    <tr><td>{{ produit.nom }}</td>    {% for f in tcs %}
                            <td><div class="pull-right"><input type="checkbox" name="phar[{{ f.id }}][]" class="js-switch" value="{{ produit.id }}"  {% for fortar in formulecocheprod %}{% if f.id ==fortar.formule.id and produit.id == fortar.produit.id %}checked{% endif %}{% endfor %} /></div> </td>
                        {% endfor %}</tr>
                    {% endfor %}
            {% endfor %}
            </tbody>
            </table>
        </div>
<input type="submit" value="enregistrer" class="btn btn-success">

    </form>

    </div>
{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('assets/plugins/switchery/switchery.min.css') }}" rel="stylesheet" />
    {% include 'hostooSanteBundle:plugins:datatable.style.html.twig' %}

{% endblock %}
{% block javascripts %}
{{ parent() }}
    <script src="{{ asset('assets/plugins/mjolnic-bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js') }}"></script>
    <script src="{{ asset('assets/plugins/switchery/switchery.min.js') }}"></script>

    {% include 'hostooSanteBundle:plugins:datatable.scripts.html.twig' %}
    <script>
        $(function () {
            //$('#mesactes').dataTable();

            var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));

            elems.forEach(function(html) {
                var switchery = new Switchery(html, { size: 'small', color: '#3DDCF7' });
            });

        });
    </script>
{% endblock %}