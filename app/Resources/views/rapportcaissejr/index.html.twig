{% extends 'hostooSanteBundle::blank.html.twig' %}
{% block menu %}
    {% include "hostooSanteBundle:menus:menucaisse.html.twig" %}
{% endblock %}
{% block titrepage %}{% endblock %}
{% block options %}<button class="btn btn-default"><i class="fa fa-print"></i> </button>{% endblock %}
{% block body %}
    <h3>Journal de Caisse</h3>
    <div class="col-md-12 col-sm-12">
<div class="card-box table-responsive">
    <table class="table table-striped table-bordered" id="printTable">
        <caption><h4>Rapport du {{ "now"|date('d/m/Y') }}</h4></caption>
        <thead>
            <tr>
                <th class="text-center">N°</th>
                <th class="text-center">Date</th>
                <th>Libellé</th>
                <th class="text-center">Report</th>
                <th class="text-center">Recette brute</th>
                <th class="text-danger text-center">Depense<br> USD</th>
                <th class="text-danger text-center">Depense<br> CDF</th>
                <th class="text-center">Recettes nettes</th>
            </tr>
        </thead>
        <tbody>
        {% set reports=0 %}
        {% set rbs=0 %}
        {% set depusd=0 %}
        {% set depcdf=0 %}
        {% set recnet=0 %}
        {% set medecin=0 %}
        {% for rapportCaisseJr in rapportCaisseJrs %}
            <tr {% if rapportCaisseJr.libelle=="Report" %} class="bg-success" {% endif %}>
               <td>{{ rapportCaisseJr.numdoc }}</td>
                <td class="text-center">{% if rapportCaisseJr.daterap %}{{ rapportCaisseJr.daterap|date('Y-m-d H:i:s') }}{% endif %}</td>
                <td>{{ rapportCaisseJr.libelle|raw }}</td>
                <td class="text-center" {% if rapportCaisseJr.libelle=="Report" %} bgcolor="#adff2f" {% endif %}>{{ rapportCaisseJr.report }}</td>{% set reports=reports+rapportCaisseJr.report %}
                <td class="text-center">{{ rapportCaisseJr.recettebrute }}</td>{% set rbs=rbs+rapportCaisseJr.recettebrute %}
                <td class="text-danger text-center">{{ rapportCaisseJr.depenseusd }}</td>{% set depusd=depusd+rapportCaisseJr.depenseusd %}
                <td class="text-danger text-center">{{ rapportCaisseJr.depensecdf }}</td>{% set depcdf=depcdf+rapportCaisseJr.depensecdf %}
                <td class="text-center">{{ rapportCaisseJr.recettenet }}</td>{% set recnet=recnet+rapportCaisseJr.recettenet %}

            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>

            <th></th>
            <th></th>
            <th></th>
            <th class="text-success text-center">{{ reports }}</th>
            <th class="text-success text-center">{{ rbs }}</th>
            <th class="text-danger text-center">{{ depusd }}</th>
            <th class="text-danger text-center">{{ depcdf }}</th>
            <th class="text-center">{{ recnet-depusd }}</th>
        </tr>
        </tfoot>
    </table>
</div>
    </div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
    function printData()
    {
        var divToPrint=document.getElementById("printTable");
        newWin= window.open("");
        newWin.document.write(divToPrint.outerHTML);
        newWin.print();
        newWin.close();
    }

    $('button').on('click',function(){
        printData();
    })
</script>

{% endblock %}